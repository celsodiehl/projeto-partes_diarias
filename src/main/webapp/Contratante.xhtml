<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/estrutura.xhtml">

	<ui:define name="titulo">Cadastro de Contratantes</ui:define>

	<h1>Cadastro de Contratantes</h1>

	<h:form id="formCadastro">

		<div class="card">

			<p:toolbar style="margin-top: 20px">

				<p:toolbarGroup>
					<p:commandButton type="button" value="Novo" icon="pi pi-plus" styleClass="mr-2" />
					<p:commandButton id="salvarBtn" value="Salvar" icon="pi pi-save" styleClass="ui-button-success"	action="#{contratanteBean.adicionar}" update=":formCadastro:messages :formCadastro" />
				</p:toolbarGroup>

				<p:toolbarGroup align="right">
					<p:button icon="pi pi-search" value="Pesquisar"	styleClass="ui-button-warning" />
				</p:toolbarGroup>
			</p:toolbar>

		</div>

		<p:messages id="messages" closable="true" />

	    <!-- FORMULARIO DE CADASTRO-->
		<div class="ui-fluid">

			<p:panelGrid columns="2" layout="grid" columnClasses="ui-grid-col-2, ui-grid-col-10" style="margin-top: 20px">
				<p:outputLabel for="nome" value="Nome" />
				<p:inputText id="nome" value="#{contratanteBean.contratante.nome}" />
				
				<p:outputLabel for="cnpj" value="CNPJ" />
				<p:inputMask id="cnpj" mask="99.999.999.9999-99" size="18" value="#{contratanteBean.contratante.cnpj}" required="true" label="CNPJ"/>
				
				<p:outputLabel for="cidade" value="Cidade" />
				<p:inputText id="cidade" value="#{contratanteBean.contratante.cidade}" />
				
				<p:outputLabel for="contato" value="Contato" />
				<p:inputText id="contato" value="#{contratanteBean.contratante.contato}" />

				<p:outputLabel for="telefone" value="Telefone" />
				<p:inputMask id="telefone" mask="99 9 9999-9999" value="#{contratanteBean.contratante.telefone}" />

			</p:panelGrid>

		</div>

	</h:form>
	
		<!-- DATATABLE COM TODOS CONTRATANTES-->
		<h:form>
			<p:dataTable value="#{contratanteBean.contratantes}" var="obj" id="tabela" paginator="true" rows="5" responsiveLayout="scroll">
			
			<p:column headerText="Contratante">
				<p:outputLabel value="#{obj.nome}" />
			</p:column>
			
			<p:column headerText="CNPJ">
				<p:outputLabel value="#{obj.cnpj}" />
			</p:column>
			
			<p:column headerText="Cidade">
				<p:outputLabel value="#{obj.cidade}" />
			</p:column>
			
			<p:column headerText="Contato">
				<p:outputLabel value="#{obj.contato}" />
			</p:column>
			
			<p:column headerText="Telefone">
				<p:outputLabel value="#{obj.telefone}" />
			</p:column>
			
			<p:column headerText="Ações" width="500">
				<p:commandButton icon="pi pi-pencil" styleClass="p-button-rounded p-button-info" update=":formDialog" process="@this" oncomplete="PF('dlgContratante').show()" 
					style="margin-top: 10px" width="100">
					<f:setPropertyActionListener value="#{obj}" target="#{contratanteBean.contratante}" />
				</p:commandButton>
				
				<p:commandButton icon="pi pi-trash" styleClass="p-button-rounded p-button-danger" process="@this" oncomplete="PF('dlgConfirmExcluir').show()" 
				update=":tabela :formCadastro">
					<f:setPropertyActionListener value="#{obj}" target="#{contratanteBean.contratante}"/>
				</p:commandButton>
			</p:column>
			
			</p:dataTable>
			
	</h:form>
	
	<!-- DIALOG DE CONFIRMAÇÃO DE EXCLUSÃO-->
	<p:dialog header="Confirmação" widgetVar="dlgConfirmExcluir" modal="true" closable="false" width="350" showEffect="fade" hideEffect="fade">

    	<h:form id="formExcluir" >

        	<h:outputText value="Deseja realmente excluir este contratante?" />
        	<br/><br/>

        	<p:commandButton value="Sim" icon="pi pi-check" styleClass="ui-button-danger" action="#{contratanteBean.excluir}"
                         update=":tabela :formCadastro" oncomplete="PF('dlgConfirmExcluir').hide()" />

        	<p:commandButton value="Não" icon="pi pi-times" type="button" onclick="PF('dlgConfirmExcluir').hide()" />

    	</h:form>

</p:dialog>
	
	<!-- DIALOG DE EDIÇÃO-->
	<p:dialog header="Editar Contratante" widgetVar="dlgContratante" modal="true" closable="true" resizable="false" styleClass="ui-fluid" width="450">

    <h:form id="formDialog">

		<div class="field">
        	<p:outputLabel value="Nome" />
        	<p:inputText value="#{contratanteBean.contratante.nome}" />
        </div>
        
        <div class="field">
        	<p:outputLabel value="CNPJ" />
        <br/>
			<p:inputMask id="cnpj" mask="99.999.999.9999-99" size="18" value="#{contratanteBean.contratante.cnpj}" required="true"/>
        </div>
        
        <div class="field">
        	<p:outputLabel value="Cidade" />
        	<p:inputText value="#{contratanteBean.contratante.cidade}" />
        </div>
        
        <div class="field">
        	<p:outputLabel value="Contato" />
        	<p:inputText value="#{contratanteBean.contratante.contato}" />
        </div>
        
        <div class="field">
        	<p:outputLabel value="Telefone" />
        	<p:inputMask id="telefone" mask="99 9 9999-9999" value="#{contratanteBean.contratante.telefone}" />
		</div>
        <br/>

        <p:commandButton value="Salvar" action="#{contratanteBean.adicionar}" update=":formCadastro :tabela" oncomplete="PF('dlgContratante').hide()" />

    </h:form>

</p:dialog>

</ui:composition>

</html>